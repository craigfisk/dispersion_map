commit 881f18fafafa6fd64123b223aa221bf7d97771ea
Author: Craig Fisk <craigfisk@picocosmos.net>
Date:   Wed Nov 7 17:52:53 2012 -0800

    Started building myfruitcake.models, views, urls, templates.  Currently stuck on Database error at /forum/ current transaction is aborted. commands ignored until end of transaction block. templates/forum/fbase.html line 48 which is if user.get_profile.avatar.  Need to dig into this on Eclipse.

diff --git a/fruitcakesite/forum/models.py b/fruitcakesite/forum/models.py
index c40e878..7fe673d 100644
--- a/fruitcakesite/forum/models.py
+++ b/fruitcakesite/forum/models.py
@@ -71,6 +71,9 @@ class UserProfile(models.Model):
     # See also forum/views.py
     avatar = models.ImageField("Profile Pic", upload_to='images', blank=True, null=True)
     posts = models.IntegerField(default=0)
+    #CF20121107 added next 2:
+    shipments = models.IntegerField(default=0)
+    receipts = models.IntegerField(default=0)
 ####    user = models.ForeignKey(User, unique=True)
     user = models.OneToOneField(User)
 
diff --git a/fruitcakesite/fruitcakesite/settings.py b/fruitcakesite/fruitcakesite/settings.py
index 1cba934..e792845 100644
--- a/fruitcakesite/fruitcakesite/settings.py
+++ b/fruitcakesite/fruitcakesite/settings.py
@@ -112,6 +112,7 @@ STATIC_ROOT = ''
 # Example: "http://media.lawrence.com/static/"
 STATIC_URL = '/static/'
 
+#CF20121107 ADMIN_MEDIA_PREFIX is removed in 1.4, see http://deathofagremmie.com/category/django/
 #ADMIN_MEDIA_PREFIX = '/static/admin/'
 
 #for django-registration
@@ -149,8 +150,9 @@ MIDDLEWARE_CLASSES = (
     'django.middleware.csrf.CsrfViewMiddleware',
     'django.contrib.auth.middleware.AuthenticationMiddleware',
     'django.contrib.messages.middleware.MessageMiddleware',
+    #CF20121107 next setting is new in 1.4, see http://deathofagremmie.com/category/django/
     # Uncomment the next line for simple clickjacking protection:
-    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
+    'django.middleware.clickjacking.XFrameOptionsMiddleware',
 )
 
 ROOT_URLCONF = 'fruitcakesite.urls'
@@ -183,6 +185,7 @@ INSTALLED_APPS = (
 ##    'world',
 #django-registration, see readthedocs
     'registration',
+#    'myfruitcake',
     'forum',
 )
 
diff --git a/fruitcakesite/fruitcakesite/urls.py b/fruitcakesite/fruitcakesite/urls.py
index 31e19ad..0e366f1 100644
--- a/fruitcakesite/fruitcakesite/urls.py
+++ b/fruitcakesite/fruitcakesite/urls.py
@@ -12,6 +12,7 @@ urlpatterns = patterns('',
     url(r'^admin/', include(admin.site.urls)),
     url(r'^polls/', include('polls.urls')),
     url(r'forum/', include('forum.urls')),
+    url(r'myfruitcake/', include('myfruitcake.urls')),
 ##    url(r'^world/', include('world.urls')),
     #CF20121104 change next line 'registration.urls' (deprecated) to 'registration.backends.default.urls'?
     #more info, see http://docs.b-list.org/django-registration/0.8/upgrade.html on how to rewrite for changes to the API
diff --git a/fruitcakesite/myfruitcake/__init__.py b/fruitcakesite/myfruitcake/__init__.py
new file mode 100644
index 0000000..e69de29
diff --git a/fruitcakesite/myfruitcake/models.py b/fruitcakesite/myfruitcake/models.py
new file mode 100644
index 0000000..7a4cc8e
--- /dev/null
+++ b/fruitcakesite/myfruitcake/models.py
@@ -0,0 +1,51 @@
+from django.db import models
+from django.contrib.auth.models import User
+from django.contrib import admin
+#from django.db.models.signals import post_save
+
+class Fruitcake(models.Model):
+    thumbnail = models.ImageField("Thumbnail Pic", upload_to='thumbnails', blank=False, null=False)
+    pic = models.ImageField("Regular Pic", upload_to='pics', blank=False, null=False)
+    source = models.URLField(max_length=200, blank=True, null=True)
+    #CF20121107: use quotes around Shipment and Upload in next 2 lines because classes not defined until below
+    shipments = models.ManyToManyField('Shipment', related_name='shipments',verbose_name='shipments')
+    uploads = models.ManyToManyField('Upload', related_name='uploads', verbose_name='uploads')
+
+    def __unicode__(self):
+        return unicode(self.thumbnail)
+
+    #CF20121107  todo; compare forum.Post.profile_data()
+    """
+    def fruitcake_data(self): 
+        uploads = self.uploads.upload_set.count()
+        shipments = self.shipments.shipment_set.count()
+        return uploads, shipments
+    """
+
+class Upload(models.Model):
+    dt = models.DateTimeField(auto_now_add=True)
+    fruitcake = models.ForeignKey(Fruitcake)
+    uploader = models.OneToOneField(User)
+
+    def __unicode__(self):
+        return unicode(self.dt)
+
+class Shipment(models.Model):
+    dt = models.DateTimeField(auto_now_add=True) 
+    fruitcake = models.ForeignKey(Fruitcake)
+    sender = models.ForeignKey(User, verbose_name='senders', related_name='senders')
+    receiver = models.ManyToManyField(User, verbose_name='addressees', related_name='receivers')
+
+    def __unicode__(self):
+        return unicode(self.dt)
+
+### Admin
+class FruitcakeAdmin(admin.ModelAdmin):
+    list_display = ['thumbnail']
+
+class UploadAdmin(admin.ModelAdmin):
+    pass
+
+class ShipmentAdmin(admin.ModelAdmin):
+    list_display = ['dt', 'fruitcake', 'sender', 'receiver']
+
diff --git a/fruitcakesite/myfruitcake/tests.py b/fruitcakesite/myfruitcake/tests.py
new file mode 100644
index 0000000..501deb7
--- /dev/null
+++ b/fruitcakesite/myfruitcake/tests.py
@@ -0,0 +1,16 @@
+"""
+This file demonstrates writing tests using the unittest module. These will pass
+when you run "manage.py test".
+
+Replace this with more appropriate tests for your application.
+"""
+
+from django.test import TestCase
+
+
+class SimpleTest(TestCase):
+    def test_basic_addition(self):
+        """
+        Tests that 1 + 1 always equals 2.
+        """
+        self.assertEqual(1 + 1, 2)
diff --git a/fruitcakesite/myfruitcake/urls.py b/fruitcakesite/myfruitcake/urls.py
new file mode 100644
index 0000000..2ddb1ce
--- /dev/null
+++ b/fruitcakesite/myfruitcake/urls.py
@@ -0,0 +1,10 @@
+from django.views.generic import DetailView, ListView, TemplateView
+from myfruitcake.models import Fruitcake, Upload, Shipment
+from myfruitcake.views import activity, upload_file, FruitcakeListView
+from django.conf.urls import patterns, include, url
+
+urlpatterns = patterns('myfruitcake.views',
+#    url(r"", "main"),
+    url(r'^$', FruitcakeListView.as_view(model=Fruitcake)),
+    url(r'^upload/$', 'upload_file'),
+)
diff --git a/fruitcakesite/myfruitcake/views.py b/fruitcakesite/myfruitcake/views.py
new file mode 100644
index 0000000..acc7ad9
--- /dev/null
+++ b/fruitcakesite/myfruitcake/views.py
@@ -0,0 +1,92 @@
+from string import join
+from PIL import Image as PImage
+from os.path import join as pjoin
+
+#CF20121107 todo: probably can cut some of these ...
+from django.contrib.auth.decorators import login_required
+from django.http import HttpResponseRedirect, HttpResponse
+from django.shortcuts import get_object_or_404, render_to_response
+from django.core.context_processors import csrf
+from django.core.paginator import Paginator, InvalidPage, EmptyPage
+from django.forms import ModelForm
+from django.contrib.auth.models import User
+from django.core.urlresolvers import reverse
+from fruitcakesite.settings import MEDIA_ROOT, MEDIA_URL, WIDTH_AVATAR
+
+from myfruitcake.models import *
+
+from django.views.generic import ListView
+
+"""
+def main(request):
+    #Main listing for myfruitcake.
+    fruitcake = Fruitcake.objects.all()
+    return render_to_response("myfruitcake/list.html", dict(fruitcake=fruitcake, user=request.user))
+"""
+
+def activity(request, pk):
+    """Listing of posts in a thread."""
+    shipments = Shipment.objects.all().order_by("dt")
+    shipments = mk_paginator(request, shipments, 15)
+    return render_to_response("myfruitcake/activity.html", add_csrf(request, shipments=shipments, media_url=MEDIA_URL))
+
+class FruitcakeListView(ListView):
+    def get_context_data(self, **kwargs):
+        context = super(FruitcakeListView, self).get_context_data(**kwargs)
+        return context
+
+    def get_queryset(self):
+        return Fruitcake.objects.all()
+
+from django import forms
+
+class UploadImageFileForm(forms.Form):
+    title = forms.CharField(max_length=50)
+    file = forms.FileField()
+
+def upload_file(request):
+    if request.method == 'POST':
+        form = UploadImageFileForm(request.POST, request.FILES)
+        if form.is_valid():
+            # do something to
+            # handle_uploaded_file(request.FILES['file'])
+            return HttpResponseRedirect('/success/')
+    else:
+        form = UploadImageFileForm()
+    return render_to_response('upload.html', {'form': form})
+
+    return render_to_response('Nothing to see yet')
+
+"""
+def make_fruitcake(request, pk):
+    profile = UserProfile.objects.get(user=pk)
+    img = None
+
+    if request.method == "POST":
+        pf = ProfileForm(request.POST, request.FILES, instance=profile)
+        if pf.is_valid():
+            pf.save()
+            # resize and save image under same filename
+            imfn = pjoin(MEDIA_ROOT, profile.avatar.name)
+            #CF20121023 adding try/except framework, per PIL-handbook p. 3
+            try:
+                im = PImage.open(imfn)
+                # 160, 160 --> 120,120 CF20121023:
+                ##im.thumbnail((120, 120), PImage.ANTIALIAS)
+                wpercent = (WIDTH_AVATAR/float(im.size[0]))
+                hsize = int((float(im.size[1])*float(wpercent)))
+                im = im.resize((WIDTH_AVATAR, hsize), PImage.ANTIALIAS)
+                im.save(imfn, "JPEG")
+            except IOError:
+                print "Cannot create thumbnail for ", imfn
+            
+    else:
+        pf = ProfileForm(instance=profile)
+
+    if profile.avatar:
+        img = MEDIA_URL + profile.avatar.name
+    return render_to_response("forum/profile.html", add_csrf(request, pf=pf, img=img))
+# remove '/' from front of /media/ in "img" line above ??
+
+"""
+
diff --git a/fruitcakesite/static/media/pics/131097039122465254_Trse3JTV_b.jpg b/fruitcakesite/static/media/pics/131097039122465254_Trse3JTV_b.jpg
new file mode 100644
index 0000000..62a0f57
Binary files /dev/null and b/fruitcakesite/static/media/pics/131097039122465254_Trse3JTV_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/156640893259624578_Fx17EopA_b.jpg b/fruitcakesite/static/media/pics/156640893259624578_Fx17EopA_b.jpg
new file mode 100644
index 0000000..1700c7a
Binary files /dev/null and b/fruitcakesite/static/media/pics/156640893259624578_Fx17EopA_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/164803667584843752_epmhVjql_b.jpg b/fruitcakesite/static/media/pics/164803667584843752_epmhVjql_b.jpg
new file mode 100644
index 0000000..ba9e72b
Binary files /dev/null and b/fruitcakesite/static/media/pics/164803667584843752_epmhVjql_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/241435229994408022_DoszNqwg_b.jpg b/fruitcakesite/static/media/pics/241435229994408022_DoszNqwg_b.jpg
new file mode 100644
index 0000000..b47ed22
Binary files /dev/null and b/fruitcakesite/static/media/pics/241435229994408022_DoszNqwg_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/27795722671260849_2XNkzMvN_b.jpg b/fruitcakesite/static/media/pics/27795722671260849_2XNkzMvN_b.jpg
new file mode 100644
index 0000000..3e85749
Binary files /dev/null and b/fruitcakesite/static/media/pics/27795722671260849_2XNkzMvN_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/36380709460037694_iBUS3kgk_b.jpg b/fruitcakesite/static/media/pics/36380709460037694_iBUS3kgk_b.jpg
new file mode 100644
index 0000000..d221cbf
Binary files /dev/null and b/fruitcakesite/static/media/pics/36380709460037694_iBUS3kgk_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/40673202855098790_uBoSgwl7_b.jpg b/fruitcakesite/static/media/pics/40673202855098790_uBoSgwl7_b.jpg
new file mode 100644
index 0000000..ca7eea5
Binary files /dev/null and b/fruitcakesite/static/media/pics/40673202855098790_uBoSgwl7_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/60446819968146915_mwJLqLyW_b.jpg b/fruitcakesite/static/media/pics/60446819968146915_mwJLqLyW_b.jpg
new file mode 100644
index 0000000..747a6bf
Binary files /dev/null and b/fruitcakesite/static/media/pics/60446819968146915_mwJLqLyW_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/64950419596308635_2VngrH7D_b.jpg b/fruitcakesite/static/media/pics/64950419596308635_2VngrH7D_b.jpg
new file mode 100644
index 0000000..62fb642
Binary files /dev/null and b/fruitcakesite/static/media/pics/64950419596308635_2VngrH7D_b.jpg differ
diff --git a/fruitcakesite/static/media/pics/94575660895330123_iXFBAhfO_b.jpg b/fruitcakesite/static/media/pics/94575660895330123_iXFBAhfO_b.jpg
new file mode 100644
index 0000000..dbcf57a
Binary files /dev/null and b/fruitcakesite/static/media/pics/94575660895330123_iXFBAhfO_b.jpg differ
diff --git a/fruitcakesite/templates/myfruitcake/fruitcake_list.html b/fruitcakesite/templates/myfruitcake/fruitcake_list.html
new file mode 100644
index 0000000..f170c14
--- /dev/null
+++ b/fruitcakesite/templates/myfruitcake/fruitcake_list.html
@@ -0,0 +1,17 @@
+<html><head><title></title></head><body>
+        <P>fruitcake_list.html</P>
+
+        {% if fruitcake_list %}
+        <P>Listing of your fruitcake:</P>
+
+        {% for item in fruitcake_list %}
+            <img src="{{ media_url }}{{ item.pic }}" />
+        {% endfor %}
+
+        {% else %}
+        So sorry, you do not have a list
+        {% endif %}
+
+
+    </body>
+</html>
diff --git a/fruitcakesite/templates/myfruitcake/index.html b/fruitcakesite/templates/myfruitcake/index.html
new file mode 100644
index 0000000..e69de29
diff --git a/fruitcakesite/templates/myfruitcake/list.html b/fruitcakesite/templates/myfruitcake/list.html
new file mode 100644
index 0000000..7ae8b1b
--- /dev/null
+++ b/fruitcakesite/templates/myfruitcake/list.html
@@ -0,0 +1,4 @@
+<html><head><title></title></head><body>
+        <P>list.html</P>
+    </body>
+</html>
diff --git a/fruitcakesite/templates/myfruitcake/success.html b/fruitcakesite/templates/myfruitcake/success.html
new file mode 100644
index 0000000..e69de29
diff --git a/fruitcakesite/templates/myfruitcake/upload.html b/fruitcakesite/templates/myfruitcake/upload.html
new file mode 100644
index 0000000..c4938aa
--- /dev/null
+++ b/fruitcakesite/templates/myfruitcake/upload.html
@@ -0,0 +1,24 @@
+<html><head><title></title></head>
+    <body>
+
+
+    <form enctype="multipart/form-data" action="" method="POST"> {% csrf_token %}
+
+        {% if form.file %} <p><img border="0" alt="Fruitcake pic" src="{{ form.file }}" /></p> 
+        
+        {% else %}Failed to find pic
+        
+        {% endif %}
+
+        <input type="text" value="title" />
+
+        <input type="text" value="file" />
+
+        <input type="submit" value="Submit" id="submit" />
+
+    </form>
+
+
+    </body>
+</html>
+

commit c3050745b084c863a80736e82b2a59a1e2d0cdbd
Author: Craig Fisk <craigfisk@picocosmos.net>
Date:   Tue Nov 6 23:55:04 2012 -0800

    Figured out scaling avatars on upload to a constant width, by simply doing the calculation and using image.resize instead of image.thumbnail

diff --git a/fruitcakesite/forum/views.py b/fruitcakesite/forum/views.py
index 1c28802..ea97bd1 100644
--- a/fruitcakesite/forum/views.py
+++ b/fruitcakesite/forum/views.py
@@ -10,7 +10,7 @@ from django.core.paginator import Paginator, InvalidPage, EmptyPage
 from django.forms import ModelForm
 from django.contrib.auth.models import User
 from django.core.urlresolvers import reverse
-from fruitcakesite.settings import MEDIA_ROOT, MEDIA_URL
+from fruitcakesite.settings import MEDIA_ROOT, MEDIA_URL, WIDTH_AVATAR
 
 from forum.models import *
 
@@ -88,7 +88,10 @@ def profile(request, pk):
             try:
                 im = PImage.open(imfn)
                 # 160, 160 --> 120,120 CF20121023:
-                im.thumbnail((120,120), PImage.ANTIALIAS)
+                ##im.thumbnail((120, 120), PImage.ANTIALIAS)
+                wpercent = (WIDTH_AVATAR/float(im.size[0]))
+                hsize = int((float(im.size[1])*float(wpercent)))
+                im = im.resize((WIDTH_AVATAR, hsize), PImage.ANTIALIAS)
                 im.save(imfn, "JPEG")
             except IOError:
                 print "Cannot create thumbnail for ", imfn
diff --git a/fruitcakesite/fruitcakesite/settings.py b/fruitcakesite/fruitcakesite/settings.py
index 865f0f5..1cba934 100644
--- a/fruitcakesite/fruitcakesite/settings.py
+++ b/fruitcakesite/fruitcakesite/settings.py
@@ -9,6 +9,9 @@ else:
 
 TEMPLATE_DEBUG = DEBUG
 
+WIDTH_AVATAR = 120
+WIDTH_FRUITCAKE = 192
+
 ADMINS = (
     ('Craig Fisk', 'craigfisk@justfruitcake.com'),
 )
diff --git a/fruitcakesite/static/fbasestyles.css b/fruitcakesite/static/fbasestyles.css
index 8800695..6012e94 100755
--- a/fruitcakesite/static/fbasestyles.css
+++ b/fruitcakesite/static/fbasestyles.css
@@ -64,7 +64,7 @@ h3 { margin-right: 30px; display: inline; }
 #list { border: 1px solid #a6cccc; width: 700px; background: #f6f6f6; }
 .post { margin: 8px; padding: 8px; border: 1px solid #ccc; margin-bottom: 14px; background: white; }
 .ppic { float: right; }
-.userinfo { width: 692px; height: 120px; margin: 25px; padding-left: 8px; padding-right: -16px; margin-bottom: 0px; background: white;  border: 1px solid #ccc; }
+.userinfo { width: 692px; height: 170px; margin: 25px; padding-left: 8px; padding-right: -16px; margin-bottom: 0px; background: white;  border: 1px solid #ccc; }
 
 .avatar { float: right; margin-right: 0px; margin-bottom: 5px;}
 
diff --git a/fruitcakesite/static/media/images/lindamagee_1347141991_24_1.jpg b/fruitcakesite/static/media/images/lindamagee_1347141991_24_1.jpg
new file mode 100755
index 0000000..2a84e70
Binary files /dev/null and b/fruitcakesite/static/media/images/lindamagee_1347141991_24_1.jpg differ
diff --git a/fruitcakesite/static/media/images/lindamagee_1347141991_24_2.jpg b/fruitcakesite/static/media/images/lindamagee_1347141991_24_2.jpg
new file mode 100755
index 0000000..159120a
Binary files /dev/null and b/fruitcakesite/static/media/images/lindamagee_1347141991_24_2.jpg differ
diff --git a/fruitcakesite/static/media/images/lindamagee_1347141991_24_3.jpg b/fruitcakesite/static/media/images/lindamagee_1347141991_24_3.jpg
new file mode 100755
index 0000000..159120a
Binary files /dev/null and b/fruitcakesite/static/media/images/lindamagee_1347141991_24_3.jpg differ
diff --git a/fruitcakesite/static/media/images/lindamagee_1347141991_24_4.jpg b/fruitcakesite/static/media/images/lindamagee_1347141991_24_4.jpg
new file mode 100755
index 0000000..159120a
Binary files /dev/null and b/fruitcakesite/static/media/images/lindamagee_1347141991_24_4.jpg differ

commit 3aea17c307efb0794f6e041f48c1ab75b3af9807
Author: Craig Fisk <craigfisk@picocosmos.net>
Date:   Tue Nov 6 23:02:36 2012 -0800

    Changed the userinfo / signin block on forum/fbase.html so that it just says "hi" if anonymous and asks to put in a photo if there is none. Also, tweaked fbasestyles.css to make the userinfo a class and the avatar another class, one div inside the other, on the model of the block of posts.

diff --git a/fruitcakesite/1 b/fruitcakesite/1
new file mode 100644
index 0000000..354f7e4
--- /dev/null
+++ b/fruitcakesite/1
@@ -0,0 +1,64 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
+<head>
+    <title>ForumApp - {% block title %}base{% endblock %}</title>
+    <!-- <meta http-equiv="refresh" content="2">  -->
+    <link rel="stylesheet" href="/static/fbasestyles.css" type="text/css" media="screen" charset="utf-8" />
+
+</head>
+
+<body>
+    <div id="sidebar">Justfruitcake
+        {% block sidebar %} - website{% endblock %} 
+    </div>
+
+    <div id="container">
+        <div id="menu">
+            {% block nav-global %}
+
+                <!-- MENU -->
+                <h3><a href="{% url forum.views.main %}">ForumApp</a></h3>
+
+                {% if user.is_staff %} <a href="{% url admin:index %}">Admin</a> {% endif %}
+                {% if user.is_authenticated %}
+                    <a href="{% url forum.views.profile user.pk %}">Edit profile</a> {% endif %}
+
+                {% if not user.is_authenticated %}<a href="/accounts/login/?next=/forum/">login</a> | <a
+                    href="/accounts/register/">register</a>{% endif %}
+
+                {% if user.is_authenticated %}<a href="/accounts/logout/?next=/forum/">logout</a>
+                    {% endif %}
+
+            {% endblock %}
+        </div>
+
+
+        <div id="userinfo"><table width="100%"><tr>
+            {% block signin %} 
+                <td valign="top">
+                {% if user.username %} 
+                <P>Hi <i>{{ user.username }}</i>!</P>
+                </td><td align="right">
+                {% elif user.username and user.get_profile.avatar %}
+                <P>Hi, <i>anonymous</i></P>
+                <img src="/static/media/{{ user.get_profile.avatar }}">
+                {% else %}
+                No photo! Please click &quot;Edit profile&quot; to upload a picture of yourself.
+                {% endif %}
+                </td>
+            {% endblock %}
+            </tr></table>
+        </div>
+
+
+
+        <div id="content">
+            {% block forum-content %}{% endblock %}
+        </div>
+    </div>
+
+</body>
+</html>
+
diff --git a/fruitcakesite/static/1 b/fruitcakesite/static/1
new file mode 100644
index 0000000..6fae927
--- /dev/null
+++ b/fruitcakesite/static/1
@@ -0,0 +1,78 @@
+/*
+ * from list.html -- notes that widths and a few other things are unique
+.main { margin-left: 25px; margin-top: 30px; }
+.title { font-size: 1.4em; margin-top: 10px; border-bottom: 0px solid #ccc; padding-left: 4px; }
+.last { border: 0px; }
+.title a { text-decoration: none; }
+.button { background: #999; color: white; padding: 4px; text-decoration: none; }
+
+td { border-bottom: 1px solid #ccc; }
+#list { border: 1px solid #ccc; width: 700px; }
+*/
+
+
+/* Fruitcake forum styles */
+
+/* From fbase.html */
+
+* {
+    color: #555;
+    font-size: 12px; /* 1.0em; *//* 0.95em; */
+    font-family: Arial, Helvetica, Gill Sans, Lucida, sans-serif;
+}
+
+#menu a {
+    text-decoration: none;
+    background: #eee;
+    border-top: 1px solid #ccc;
+    border-bottom: 1px solid #ccc;
+    border-right: 2px solid #fff;
+    padding-right: 3px;
+    padding-left: 3px;
+/*            color: red; *//* #777; */
+    font-size: 0.9em; 
+}
+
+a:hover {
+    background: #eeebeb;
+    border-top: 1px solid #aaa;
+    border-bottom: 1px solid #aaa;
+    color: #555; 
+}
+
+#container { margin: auto; width: 800px; border: 0px solid; }
+
+h3 { margin-right: 30px; display: inline; }
+
+#sidebar { font-size: 1.6em; color: red; margin-bottom: 20px; border-bottom: 1px solid #ccc;}
+
+#userinfo { margin-left: 25px; width: 700px; }
+
+/* font-size: 1.4em; */
+
+/* from thread.html */
+
+.pagination { margin-top: 20px; margin-left: -20px; }
+.main { margin-left: 25px; margin-top: 30px; width: 700px; }
+.title { margin-top: 10px; padding-left: 0px; }
+.title a { text-decoration: none;}
+.button { background: #999; color: white; padding: 6px; text-decoration: none; float: right; }
+.date { padding-left: 5px; font-size: 0.8em; } 
+.clear { clear: both; }
+.last { border: 0px; }
+
+#list { border: 1px solid #a6cccc; width: 700px; background: #f6f6f6; }
+.post { margin: 8px; padding: 8px; border: 1px solid #ccc; margin-bottom: 14px; background: white; }
+.ppic { float: right; }
+.userinfo { width: 700px; height: 120px; margin: 25px; padding: 0px; border: 1px solid #ccc; margin-bottom: 0px; background: white; }
+.avatar { float: right; margin-right: 20px; margin-bottom: 5px;}
+
+#back { margin: 5px; }
+
+.ttitle {
+    font-style: bold; font-size: 1.0em; border-bottom: 1px solid #ccc; margin-bottom: 9px;
+    padding-left: 10px; width: 700px;
+}
+/* font-size: 1.3em; */
+
+
diff --git a/fruitcakesite/static/fbasestyles.css b/fruitcakesite/static/fbasestyles.css
index 3632974..8800695 100755
--- a/fruitcakesite/static/fbasestyles.css
+++ b/fruitcakesite/static/fbasestyles.css
@@ -58,16 +58,17 @@ h3 { margin-right: 30px; display: inline; }
 .title a { text-decoration: none;}
 .button { background: #999; color: white; padding: 6px; text-decoration: none; float: right; }
 .date { padding-left: 5px; font-size: 0.8em; } 
-.ppic { float: right; }
 .clear { clear: both; }
 .last { border: 0px; }
 
-.post {
-    margin: 8px; padding: 8px; border: 1px solid #ccc; margin-bottom: 14px; background: white;
-    }
 #list { border: 1px solid #a6cccc; width: 700px; background: #f6f6f6; }
-#back { margin: 5px; }
+.post { margin: 8px; padding: 8px; border: 1px solid #ccc; margin-bottom: 14px; background: white; }
+.ppic { float: right; }
+.userinfo { width: 692px; height: 120px; margin: 25px; padding-left: 8px; padding-right: -16px; margin-bottom: 0px; background: white;  border: 1px solid #ccc; }
 
+.avatar { float: right; margin-right: 0px; margin-bottom: 5px;}
+
+#back { margin: 5px; }
 
 .ttitle {
     font-style: bold; font-size: 1.0em; border-bottom: 1px solid #ccc; margin-bottom: 9px;
diff --git a/fruitcakesite/templates/forum/fbase.html b/fruitcakesite/templates/forum/fbase.html
index a46d117..d37825d 100755
--- a/fruitcakesite/templates/forum/fbase.html
+++ b/fruitcakesite/templates/forum/fbase.html
@@ -34,26 +34,23 @@
             {% endblock %}
         </div>
 
-
-        <div id="userinfo"><table width="100%"><tr>
-            {% block signin %} 
-                <td valign="top">
-                {% if user.username %} 
-                <P>Hi <i>{{ user.username }}</i>!</P>
-                {% else %}
-                {% comment %} <p>Hi anonymous!</P>{% endcomment %}
-                {% endif %}
-                </td><td align="right">
+        
+        {% block signin %}
+        <div class="userinfo">
+            {% if user.username and user.get_profile.avatar %}
+                Hi, <i>{{ user.username }}</i>
+            {% elif user.username and not user.get_profile.avatar %}
+                Hi, <i>{{ user.username }}</i>. No photo! It would be nice if you would please click &quot;Edit profile&quot; and upload a picture of yourself.
+            {% else %}
+                Hi!
+            {% endif %}
+            <div class="avatar">
                 {% if user.get_profile.avatar %}
                 <img src="/static/media/{{ user.get_profile.avatar }}">
-                {% else %}
-                No photo! Please click &quot;Edit profile&quot; to upload a picture of yourself.
                 {% endif %}
-                </td>
-            {% endblock %}
-            </tr></table>
+            </div>
         </div>
-
+        {% endblock %}
 
 
         <div id="content">
diff --git a/fruitcakesite/templates/index.html b/fruitcakesite/templates/index.html
index dfe5fe0..146cc9a 100644
--- a/fruitcakesite/templates/index.html
+++ b/fruitcakesite/templates/index.html
@@ -7,6 +7,7 @@ Home page
 
 {% block sidebar %} - home page{% endblock %}
 
+
 {% block forum-content %}
    <div class='title'>
        <P><b><span style="color:red;">Justfruitcake</b></span> is <i>virtual</i> fruitcake... that you can send to your friends, and then they, um, can send to their friends, and then ...!</P>

commit cdfdf5fbc3a04e68998e9490d27b42a7ed46923f
Author: Craig Fisk <craigfisk@picocosmos.net>
Date:   Tue Nov 6 18:53:50 2012 -0800

    Figured out nginx config to rewrite non-port-8000 requests to port 8000, added a few columns to list_displays for admin section of forum/models

diff --git a/distribute-0.6.30.tar.gz b/distribute-0.6.30.tar.gz
deleted file mode 100644
index 13b3f53..0000000
Binary files a/distribute-0.6.30.tar.gz and /dev/null differ
diff --git a/fruitcakesite/deployment/README b/fruitcakesite/deployment/README
index 88d0167..43fee79 100644
--- a/fruitcakesite/deployment/README
+++ b/fruitcakesite/deployment/README
@@ -1,8 +1,10 @@
-nginx.conf and fruitcake_vassal.ini (<-- django.ini) are the only config files being used here.
+Justfruitcake config files for nginx and uwsgi Emperor mode (app = a vassal).
 
-nginx.conf is symlinked to /etc/nginx/sites-enabled/  Note the final "/"!!
+1) fruitcake_nginx.conf is symlinked to /etc/nginx/sites-enabled/www.justfruitcake.com
 
-fruitcake-vassal.ini is the uwsgi control file.  Note carefully how it is symlinked:
-    sudo ln -sfn /home/fisk/virt/justfruitcake/fruitcakesite/deployment/fruitcake_vassal.ini /etc/uwsgi/vassal/
+2) fruitcake-vassal.ini is the uwsgi control file.  It is symlinked to /etc/uwsgi/vassals/
+     Note carefully how it is symlinked:
+        sudo ln -sfn /home/fisk/virt/justfruitcake/fruitcakesite/deployment/fruitcake_vassal.ini /etc/uwsgi/vassals/
 
+-------------------------------------------------------------------------
 The other files are leftover from attempting to get Emperor mode running.
diff --git a/fruitcakesite/deployment/fruitcake_nginx.conf b/fruitcakesite/deployment/fruitcake_nginx.conf
new file mode 100644
index 0000000..73f3264
--- /dev/null
+++ b/fruitcakesite/deployment/fruitcake_nginx.conf
@@ -0,0 +1,55 @@
+# nginx.conf
+
+upstream django {
+    # connect to this socket
+    server unix:///tmp/uwsgi.sock;    # for a file socket
+#    server 127.0.0.1:8001;              # for web port socket
+    }
+
+server {
+    listen www.justfruitcake.com:80;
+    server_name www.justfruitcake.com;
+
+    access_log /var/log/nginx/fruitcake_80_access.log;
+    error_log /var/log/nginx/fruitcake_80_error.log;
+
+    rewrite ^ http://$server_name:8000$request_uri? permanent;
+}
+
+server {
+    listen 8000;
+    server_name www.justfruitcake.com justfruitcake.com;
+
+    access_log /var/log/nginx/fruitcake_access.log;
+    error_log /var/log/nginx/fruitcake_error.log;
+
+    charset utf-8;
+
+    allow 70.102.23.162;    # CMNW office
+    allow 67.168.194.54;    # Craig home
+    allow 75.93.45.221;     # picocosmos office
+    allow 98.232.246.175;   # Kirk Hirschfeld
+#    allow 207.224.17.144;  # Steve Cayford
+    deny all;
+
+    # max upload size
+    client_max_body_size 75M;
+ 
+    location = /robots.txt { log_not_found off; access_log off; }
+    location = /favicon.ico {access_log off; log_not_found off; }
+    
+    # django media
+    location /media {
+        alias /home/fisk/virt/justfruitcake/fruitcakesite/static/media;
+    }
+    location /static {
+         alias /home/fisk/virt/justfruitcake/fruitcakesite/static;
+    }
+  
+    # send everything else to the Django server
+    location / {
+        uwsgi_pass  django;
+        include /etc/nginx/uwsgi_params;
+    }
+}
+ 
diff --git a/fruitcakesite/deployment/nginx.conf b/fruitcakesite/deployment/nginx.conf
deleted file mode 100644
index 1418a5f..0000000
--- a/fruitcakesite/deployment/nginx.conf
+++ /dev/null
@@ -1,34 +0,0 @@
-# nginx.conf
-
-upstream django {
-    # connect to this socket
-    server unix:///tmp/uwsgi.sock;    # for a file socket
-#    server 127.0.0.1:8001;              # for web port socket
-    }
-
-server {
-    listen 8000;
-    server_name www.justfruitcake.com justfruitcake.com;
-    charset utf-8;
-
-    # max upload size
-    client_max_body_size 75M;
- 
-    location = /robots.txt { log_not_found off; access_log off; }
-    location = /favicon.ico {access_log off; log_not_found off; }
-    
-    # django media
-    location /media {
-        alias /home/fisk/virt/justfruitcake/fruitcakesite/static/media;
-    }
-    location /static {
-         alias /home/fisk/virt/justfruitcake/fruitcakesite/static;
-    }
-  
-    # send everything else to the Django server
-    location / {
-        uwsgi_pass  django;
-        include /etc/nginx/uwsgi_params;
-    }
-}
- 
diff --git a/fruitcakesite/forum/models.py b/fruitcakesite/forum/models.py
index 50e2f01..c40e878 100644
--- a/fruitcakesite/forum/models.py
+++ b/fruitcakesite/forum/models.py
@@ -82,13 +82,13 @@ class UserProfile(models.Model):
 ### Admin
 
 class ProfileAdmin(admin.ModelAdmin):
-    list_display = ["user"]
+    list_display = ["user", "posts", "avatar"]
 
 class ForumAdmin(admin.ModelAdmin):
     pass
 
 class ThreadAdmin(admin.ModelAdmin):
-    list_display = ["title", "forum", "creator", "created"]
+    list_display = ["title", "forum", "creator", "created", "num_posts", "last_post"]
     list_filter = ["forum", "creator"]
 
 class PostAdmin(admin.ModelAdmin):
diff --git a/fruitcakesite/static/media/images/193865958928961803_K9ktZ0xA_b.jpg b/fruitcakesite/static/media/images/193865958928961803_K9ktZ0xA_b.jpg
new file mode 100755
index 0000000..3e10a65
Binary files /dev/null and b/fruitcakesite/static/media/images/193865958928961803_K9ktZ0xA_b.jpg differ
diff --git a/fruitcakesite/static/media/images/193865958928961803_K9ktZ0xA_b_1.jpg b/fruitcakesite/static/media/images/193865958928961803_K9ktZ0xA_b_1.jpg
new file mode 100755
index 0000000..3e10a65
Binary files /dev/null and b/fruitcakesite/static/media/images/193865958928961803_K9ktZ0xA_b_1.jpg differ
diff --git a/fruitcakesite/static/media/images/216946907019878933_xBy1BhzU_b.jpg b/fruitcakesite/static/media/images/216946907019878933_xBy1BhzU_b.jpg
new file mode 100755
index 0000000..9618031
Binary files /dev/null and b/fruitcakesite/static/media/images/216946907019878933_xBy1BhzU_b.jpg differ
diff --git a/fruitcakesite/static/media/images/IMAG0276.jpg b/fruitcakesite/static/media/images/IMAG0276.jpg
new file mode 100755
index 0000000..9175e84
Binary files /dev/null and b/fruitcakesite/static/media/images/IMAG0276.jpg differ
diff --git a/fruitcakesite/static/media/images/IMG_0183.JPG b/fruitcakesite/static/media/images/IMG_0183.JPG
new file mode 100755
index 0000000..e72f2fc
Binary files /dev/null and b/fruitcakesite/static/media/images/IMG_0183.JPG differ
diff --git a/fruitcakesite/static/media/images/Sweet_Pea_2007.jpg b/fruitcakesite/static/media/images/Sweet_Pea_2007.jpg
new file mode 100755
index 0000000..aafdaa7
Binary files /dev/null and b/fruitcakesite/static/media/images/Sweet_Pea_2007.jpg differ
diff --git a/fruitcakesite/templates/registration/registration_complete.html b/fruitcakesite/templates/registration/registration_complete.html
index f5fd625..875a510 100644
--- a/fruitcakesite/templates/registration/registration_complete.html
+++ b/fruitcakesite/templates/registration/registration_complete.html
@@ -3,6 +3,8 @@
         <title>Registration Complete</title>
     </head>
     <body>
-        <h2>Registration Complete! (<i>Please check your email to activate and then sign in to Justfruitcake.</i>)</h2>
+        <h2>Registration Complete!</h2>
+        <P><i>Please check your <u>email</u> to activate and then sign in to </i><b><span style="color:red;"><a
+                    href="http://www.justfruitcake.com">www.justfruitcake.com</a></span></b>.</P>
     </body>
 </html>

commit 75c8fe164d1555865115bbd29c78f0816eb1bb19
Author: Craig Fisk <craigfisk@picocosmos.net>
Date:   Tue Nov 6 15:24:36 2012 -0800

    Not sure I added anything here

diff --git a/fruitcakesite/static/media/images/IMG_0201.JPG b/fruitcakesite/static/media/images/IMG_0201.JPG
new file mode 100755
index 0000000..5013b81
Binary files /dev/null and b/fruitcakesite/static/media/images/IMG_0201.JPG differ
